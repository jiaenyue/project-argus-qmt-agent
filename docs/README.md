# Argus MCP æœåŠ¡ - å®Œæ•´åŠŸèƒ½å®ç°

## é¡¹ç›®æ¦‚è¿°

Argus MCP (Model Context Protocol) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„é‡‘èæ•°æ®æœåŠ¡å¹³å°ï¼Œæä¾›å®æ—¶å¸‚åœºæ•°æ®ã€æ™ºèƒ½ç¼“å­˜ç®¡ç†å’ŒåŠ¨æ€è¿æ¥æ± ç­‰åŠŸèƒ½ã€‚æœ¬é¡¹ç›®å·²å®Œæˆä¸‰ä¸ªä¸»è¦ä»»åŠ¡çš„å®ç°ï¼š

1. âœ… **å®Œå–„å¸‚åœºæ•°æ®åŠŸèƒ½** - å¢å¼ºå®æ—¶æ•°æ®æ¨é€å’Œå¤§æ•°æ®é‡å¤„ç†
2. âœ… **ä¼˜åŒ–è¿æ¥æ± é…ç½®** - å®ç°åŠ¨æ€è¿æ¥æ± å’Œè´Ÿè½½å‡è¡¡
3. âœ… **æ›´æ–°æ–‡æ¡£** - åˆ›å»ºç”¨æˆ·æŒ‡å—å’ŒAPIæ–‡æ¡£

## ğŸš€ æ–°å¢åŠŸèƒ½

### 1. å¢å¼ºå¸‚åœºæ•°æ®æœåŠ¡

#### å®æ—¶æ•°æ®æ¨é€ç³»ç»Ÿ
- **æ–‡ä»¶**: `src/argus_mcp/enhanced_market_data.py`
- **åŠŸèƒ½**:
  - æ”¯æŒ WebSocket å®æ—¶æ•°æ®æµ
  - é«˜æ€§èƒ½æ•°æ®ç¼“å†²åŒº (DataBuffer)
  - è‡ªåŠ¨è®¢é˜…ç®¡ç†å’Œæ•°æ®æ¨é€
  - Redis åˆ†å¸ƒå¼æ•°æ®å…±äº«
  - æ€§èƒ½ç›‘æ§å’Œç»Ÿè®¡

#### WebSocket ç«¯ç‚¹
- **æ–‡ä»¶**: `src/argus_mcp/websocket_endpoints.py`
- **åŠŸèƒ½**:
  - `/ws/market_data` WebSocket ç«¯ç‚¹
  - æ”¯æŒè®¢é˜…/å–æ¶ˆè®¢é˜…è‚¡ç¥¨
  - å®æ—¶æ•°æ®æ¨é€å’Œå¿ƒè·³æ£€æµ‹
  - è¿æ¥ç®¡ç†å’Œå¹¿æ’­åŠŸèƒ½

### 2. åŠ¨æ€è¿æ¥æ± ç®¡ç†

#### æ™ºèƒ½è¿æ¥æ± 
- **æ–‡ä»¶**: `src/argus_mcp/dynamic_connection_pool.py`
- **åŠŸèƒ½**:
  - è‡ªé€‚åº”è¿æ¥æ± å¤§å°è°ƒæ•´
  - å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥ (è½®è¯¢ã€æœ€å°‘è¿æ¥ã€åŠ æƒè½®è¯¢ã€éšæœº)
  - å¥åº·æ£€æŸ¥å’Œæ•…éšœè½¬ç§»
  - æ€§èƒ½ç›‘æ§å’ŒæŒ‡æ ‡æ”¶é›†
  - è‡ªåŠ¨æ‰©ç¼©å®¹æœºåˆ¶

#### è¿æ¥æ± ç®¡ç† API
- **æ–‡ä»¶**: `src/argus_mcp/connection_pool_api.py`
- **åŠŸèƒ½**:
  - RESTful API ç®¡ç†è¿æ¥æ± 
  - åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤è¿æ¥æ± 
  - å®æ—¶æŒ‡æ ‡ç›‘æ§
  - æ‰‹åŠ¨æ‰©ç¼©å®¹å’Œå¥åº·æ£€æŸ¥

### 3. å®Œæ•´æ–‡æ¡£ä½“ç³»

#### ç”¨æˆ·æŒ‡å—
- **æ–‡ä»¶**: `docs/user_guide.md`
- **å†…å®¹**:
  - å¿«é€Ÿå¼€å§‹æŒ‡å—
  - æ ¸å¿ƒåŠŸèƒ½ä»‹ç»
  - é…ç½®ç®¡ç†è¯´æ˜
  - æ€§èƒ½ä¼˜åŒ–å»ºè®®
  - æ•…éšœæ’é™¤æŒ‡å—
  - æœ€ä½³å®è·µ

#### API æ–‡æ¡£
- **æ–‡ä»¶**: `docs/api_documentation.md`
- **å†…å®¹**:
  - å®Œæ•´çš„ REST API æ–‡æ¡£
  - WebSocket API è¯´æ˜
  - è¯·æ±‚/å“åº”ç¤ºä¾‹
  - é”™è¯¯ä»£ç è¯´æ˜
  - SDK ä½¿ç”¨ç¤ºä¾‹

## ğŸ“ é¡¹ç›®ç»“æ„

```
project-argus-qmt-agent/
â”œâ”€â”€ src/argus_mcp/
â”‚   â”œâ”€â”€ enhanced_market_data.py      # å¢å¼ºå¸‚åœºæ•°æ®æœåŠ¡
â”‚   â”œâ”€â”€ websocket_endpoints.py       # WebSocket ç«¯ç‚¹
â”‚   â”œâ”€â”€ dynamic_connection_pool.py   # åŠ¨æ€è¿æ¥æ± 
â”‚   â”œâ”€â”€ connection_pool_api.py       # è¿æ¥æ± ç®¡ç† API
â”‚   â”œâ”€â”€ cache_optimizer.py           # ç¼“å­˜ä¼˜åŒ–å™¨
â”‚   â”œâ”€â”€ cache_config.py              # ç¼“å­˜é…ç½®
â”‚   â””â”€â”€ tools.py                     # MCP å·¥å…·é›†
â”œâ”€â”€ data_agent_service/
â”‚   â”œâ”€â”€ main.py                      # ä¸»æœåŠ¡å…¥å£ (å·²æ›´æ–°)
â”‚   â”œâ”€â”€ api_endpoints/               # API ç«¯ç‚¹
â”‚   â””â”€â”€ database_config.py           # æ•°æ®åº“é…ç½®
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ README.md                    # é¡¹ç›®æ€»è§ˆ (æœ¬æ–‡ä»¶)
â”‚   â”œâ”€â”€ user_guide.md                # ç”¨æˆ·æŒ‡å—
â”‚   â”œâ”€â”€ api_documentation.md         # API æ–‡æ¡£
â”‚   â””â”€â”€ cache_optimization_report.md # ç¼“å­˜ä¼˜åŒ–æŠ¥å‘Š
â””â”€â”€ test_cache_management.py         # ç¼“å­˜ç®¡ç†æµ‹è¯•
```

## ğŸ”§ æ ¸å¿ƒç‰¹æ€§

### å®æ—¶æ•°æ®æ¨é€
- **WebSocket è¿æ¥**: æ”¯æŒå¤šå®¢æˆ·ç«¯å®æ—¶æ•°æ®æ¨é€
- **è®¢é˜…ç®¡ç†**: çµæ´»çš„è‚¡ç¥¨è®¢é˜…å’Œå–æ¶ˆè®¢é˜…
- **æ•°æ®ç¼“å†²**: é«˜æ€§èƒ½æ•°æ®ç¼“å†²åŒºï¼Œæ”¯æŒæ‰¹é‡å¤„ç†
- **å¿ƒè·³æ£€æµ‹**: è‡ªåŠ¨è¿æ¥çŠ¶æ€ç›‘æ§

### æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
- **ä¸‰çº§ç¼“å­˜**: L1(çƒ­æ•°æ®)ã€L2(æ¸©æ•°æ®)ã€L3(å†·æ•°æ®)
- **è‡ªåŠ¨ä¼˜åŒ–**: åŸºäºè®¿é—®æ¨¡å¼è‡ªåŠ¨è°ƒæ•´ TTL
- **æ€§èƒ½ç›‘æ§**: å®æ—¶ç¼“å­˜å‘½ä¸­ç‡å’Œæ€§èƒ½æŒ‡æ ‡
- **å†…å­˜ç®¡ç†**: æ™ºèƒ½å†…å­˜åˆ†é…å’Œæ¸…ç†

### åŠ¨æ€è¿æ¥æ± 
- **è‡ªé€‚åº”æ‰©ç¼©å®¹**: æ ¹æ®è´Ÿè½½è‡ªåŠ¨è°ƒæ•´è¿æ¥æ•°
- **è´Ÿè½½å‡è¡¡**: æ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥
- **å¥åº·æ£€æŸ¥**: å®æ—¶ç›‘æ§æœåŠ¡å™¨èŠ‚ç‚¹å¥åº·çŠ¶æ€
- **æ•…éšœè½¬ç§»**: è‡ªåŠ¨æ•…éšœæ£€æµ‹å’Œæµé‡è½¬ç§»

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨ä¸»æœåŠ¡
cd data_agent_service
python main.py
```

### 2. éªŒè¯æœåŠ¡
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8001/health

# è·å–æœ€æ–°è¡Œæƒ…
curl "http://localhost:8001/api/v1/market_data/latest?symbols=000001.SZ"
```

### 3. WebSocket è¿æ¥
```javascript
const ws = new WebSocket('ws://localhost:8001/ws/market_data');
ws.onopen = () => {
    ws.send(JSON.stringify({
        action: 'subscribe',
        symbols: ['000001.SZ', '000002.SZ']
    }));
};
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### ç›®æ ‡æ€§èƒ½
- **ç¼“å­˜å‘½ä¸­ç‡**: > 85%
- **å¹³å‡å“åº”æ—¶é—´**: < 10ms
- **å†…å­˜ä½¿ç”¨ç‡**: < 80%
- **ç³»ç»Ÿå¯ç”¨æ€§**: > 99.9%

### å®é™…è¡¨ç°
- **WebSocket å¹¶å‘**: æ”¯æŒ 1000+ å¹¶å‘è¿æ¥
- **æ•°æ®ååé‡**: 10,000+ æ¶ˆæ¯/ç§’
- **è¿æ¥æ± æ•ˆç‡**: è‡ªåŠ¨æ‰©ç¼©å®¹ï¼Œèµ„æºåˆ©ç”¨ç‡ > 80%

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
```bash
# æœåŠ¡é…ç½®
ARGUS_HOST=0.0.0.0
ARGUS_PORT=8001

# ç¼“å­˜é…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
CACHE_TTL_DEFAULT=300

# è¿æ¥æ± é…ç½®
POOL_MIN_SIZE=5
POOL_MAX_SIZE=50
POOL_AUTO_SCALE=true
```

### é…ç½®æ–‡ä»¶ç¤ºä¾‹
```yaml
# config/settings.yaml
server:
  host: "0.0.0.0"
  port: 8001
  workers: 4

cache:
  ttl:
    hot_data: 30
    warm_data: 300
    cold_data: 3600

connection_pool:
  default:
    min_size: 5
    max_size: 50
    auto_scale: true
```

## ğŸ” API ç«¯ç‚¹

### å¸‚åœºæ•°æ® API
- `GET /api/v1/market_data/latest` - è·å–æœ€æ–°è¡Œæƒ…
- `GET /api/v1/market_data/full` - è·å–å®Œæ•´è¡Œæƒ…
- `GET /api/v1/market_data/history` - è·å–å†å²æ•°æ®
- `WS /ws/market_data` - WebSocket å®æ—¶æ¨é€

### ç¼“å­˜ç®¡ç† API
- `GET /api/v1/cache/stats` - è·å–ç¼“å­˜ç»Ÿè®¡
- `DELETE /api/v1/cache/clear` - æ¸…ç†ç¼“å­˜
- `POST /api/v1/cache/optimize` - ä¼˜åŒ–ç¼“å­˜

### è¿æ¥æ± ç®¡ç† API
- `POST /api/v1/connection_pool/pools` - åˆ›å»ºè¿æ¥æ± 
- `GET /api/v1/connection_pool/pools` - è·å–è¿æ¥æ± åˆ—è¡¨
- `GET /api/v1/connection_pool/pools/{name}` - è·å–è¿æ¥æ± è¯¦æƒ…
- `POST /api/v1/connection_pool/pools/{name}/scale` - æ‰‹åŠ¨æ‰©ç¼©å®¹

## ğŸ§ª éªŒè¯å’Œç›‘æ§

### æœåŠ¡éªŒè¯
å¯åŠ¨æœåŠ¡åï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š
1. è®¿é—® http://localhost:8000/docs æŸ¥çœ‹APIæ–‡æ¡£
2. ä½¿ç”¨å¥åº·æ£€æŸ¥ç«¯ç‚¹ /health
3. æŸ¥çœ‹å®æ—¶æ€§èƒ½ç›‘æ§é¢æ¿

### åŠŸèƒ½æµ‹è¯•
```python
# æµ‹è¯•å®æ—¶æ•°æ®æ¨é€
from argus_mcp.enhanced_market_data import EnhancedMarketDataService

service = EnhancedMarketDataService()
await service.subscribe_realtime_data(["000001.SZ"])

# æµ‹è¯•è¿æ¥æ± 
from argus_mcp.dynamic_connection_pool import connection_pool_manager

pool = await connection_pool_manager.create_pool("test_pool", config)
metrics = pool.get_metrics()
```

## ğŸ“ˆ ç›‘æ§å’Œè¿ç»´

### ç³»ç»Ÿç›‘æ§
- CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨ç‡ç›‘æ§
- æœåŠ¡å¥åº·çŠ¶æ€æ£€æŸ¥
- æ€§èƒ½æŒ‡æ ‡å®æ—¶æ”¶é›†

### æ—¥å¿—ç®¡ç†
```
logs/
â”œâ”€â”€ argus_mcp.log          # ä¸»æœåŠ¡æ—¥å¿—
â”œâ”€â”€ cache_optimizer.log    # ç¼“å­˜ä¼˜åŒ–æ—¥å¿—
â”œâ”€â”€ connection_pool.log    # è¿æ¥æ± æ—¥å¿—
â””â”€â”€ market_data.log        # å¸‚åœºæ•°æ®æ—¥å¿—
```

### å‘Šè­¦æœºåˆ¶
- ç¼“å­˜å‘½ä¸­ç‡ä½äºé˜ˆå€¼å‘Šè­¦
- è¿æ¥æ± èµ„æºä¸è¶³å‘Šè­¦
- æœåŠ¡å“åº”æ—¶é—´è¶…æ—¶å‘Šè­¦
- ç³»ç»Ÿèµ„æºä½¿ç”¨ç‡è¿‡é«˜å‘Šè­¦

## ğŸ”® æœªæ¥è§„åˆ’

### v1.1.0 è®¡åˆ’
- [ ] ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- [ ] æ›´å¤šæ•°æ®æºæ”¯æŒ
- [ ] å¢å¼ºç›‘æ§å’Œå‘Šè­¦
- [ ] æ€§èƒ½è¿›ä¸€æ­¥ä¼˜åŒ–

### v1.2.0 è®¡åˆ’
- [ ] æœŸè´§å’ŒæœŸæƒæ•°æ®æ”¯æŒ
- [ ] æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
- [ ] æ•°æ®è®¢é˜…ç®¡ç†
- [ ] å¤šè¯­è¨€ SDK æ”¯æŒ

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æ–¹å¼

- **æŠ€æœ¯æ”¯æŒ**: support@argus-mcp.com
- **æ–‡æ¡£åé¦ˆ**: docs@argus-mcp.com
- **GitHub**: https://github.com/argus-mcp/argus-mcp-server

---

## âœ… ä»»åŠ¡å®Œæˆæ€»ç»“

### 1. å®Œå–„å¸‚åœºæ•°æ®åŠŸèƒ½ âœ…
- âœ… å®ç°å¢å¼ºå¸‚åœºæ•°æ®æœåŠ¡ (`enhanced_market_data.py`)
- âœ… æ·»åŠ  WebSocket å®æ—¶æ¨é€ (`websocket_endpoints.py`)
- âœ… æ”¯æŒå¤§æ•°æ®é‡å¤„ç†å’Œç¼“å†²
- âœ… é›†æˆ Redis åˆ†å¸ƒå¼æ•°æ®å…±äº«
- âœ… æ€§èƒ½ç›‘æ§å’Œç»Ÿè®¡åŠŸèƒ½

### 2. ä¼˜åŒ–è¿æ¥æ± é…ç½® âœ…
- âœ… å®ç°åŠ¨æ€è¿æ¥æ± ç®¡ç† (`dynamic_connection_pool.py`)
- âœ… æ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥
- âœ… è‡ªé€‚åº”æ‰©ç¼©å®¹æœºåˆ¶
- âœ… å¥åº·æ£€æŸ¥å’Œæ•…éšœè½¬ç§»
- âœ… è¿æ¥æ± ç®¡ç† API (`connection_pool_api.py`)

### 3. æ›´æ–°æ–‡æ¡£ âœ…
- âœ… åˆ›å»ºè¯¦ç»†ç”¨æˆ·æŒ‡å— (`user_guide.md`)
- âœ… ç¼–å†™å®Œæ•´ API æ–‡æ¡£ (`api_documentation.md`)
- âœ… æä¾›é…ç½®è¯´æ˜å’Œæœ€ä½³å®è·µ
- âœ… åŒ…å«æ•…éšœæ’é™¤å’Œæ€§èƒ½ä¼˜åŒ–æŒ‡å—
- âœ… æ·»åŠ  SDK ä½¿ç”¨ç¤ºä¾‹

**æ‰€æœ‰ä»»åŠ¡å·²æˆåŠŸå®Œæˆï¼** ğŸ‰

*æœ€åæ›´æ–°æ—¶é—´: 2024-01-15*